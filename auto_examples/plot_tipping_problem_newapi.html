


<!DOCTYPE html>
<html lang="en">
<head>
        <title>Fuzzy Control Systems: The Tipping Problem &mdash; skfuzzy v0.4.2 docs</title>
    
    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link href="../_static/css/bootstrap.min.css" rel="stylesheet" type="text/css">
    <link href="../_static/css/custom.css" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Raleway" rel="stylesheet" type="text/css">
    
    <script src="http://code.jquery.com/jquery-latest.js"></script>
    <script src="../_static/js/bootstrap.min.js"></script>
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.4.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <link rel="index" title="Index" href="../genindex.html" />
        <link rel="search" title="Search" href="../search.html" />
        <link rel="top" title="skfuzzy v0.4.2 docs" href="../index.html" />
        <link rel="up" title="General examples" href="index.html" />
        <link rel="next" title="&lt;no title&gt;" href="../documentation.html" />
        <link rel="prev" title="The Tipping Problem - The Hard Way" href="plot_tipping_problem.html" />
    <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
    <link rel="shortcut icon" href="../_static/favicon.ico">
</head>
<body class="container">
    <a href="../index.html" class="logo"><img src="../_static/img/logo.png" alt=""></a>
    <div class="clearfix"></div>
    <div class="navbar">
        <div class="navbar-inner">
            <ul class="nav">
                <li><a href="../index.html">Home</a></li>
<li><a href="../user_guide.html">User Guide</a></li>
<li><a href="index.html">Example Gallery</a></li>
<li><a href="../api/index.html">API Documentation</a></li>
<li><a href="https://github.com/scikit-fuzzy/scikit-fuzzy">
    <img src="../_static/GitHub-Mark-32px.png"
        style="height: 15px; width: 15px;
               display: inline; float: none;
               padding-bottom: 3px;">
    Source</a>
</li>
            </ul>
            <form class="navbar-form pull-right" action="../search.html" method="get">
                <input type="text" class="search span3" name="q" placeholder="Search documentation ...">
                <input type="hidden" name="check_keywords" value="yes" >
                <input type="hidden" name="area" value="default" >
            </form>
        </div>
    </div>
    <div class="row">
        <div class="span9">
            
  <div class="section" id="fuzzy-control-systems-the-tipping-problem">
<span id="example-plot-tipping-problem-newapi-py"></span><h1>Fuzzy Control Systems: The Tipping Problem<a class="headerlink" href="#fuzzy-control-systems-the-tipping-problem" title="Permalink to this headline">¶</a></h1>
<p>The ‘tipping problem’ is commonly used to illustrate the power of fuzzy logic
principles to generate complex behavior from a compact, intuitive set of
expert rules.</p>
<p>If you’re new to the world of fuzzy control systems, you might want
to check out the <a class="reference external" href="../userguide/fuzzy_control_primer.html">Fuzzy Control Primer</a>
before reading through this worked example.</p>
<div class="section" id="the-tipping-problem">
<h2>The Tipping Problem<a class="headerlink" href="#the-tipping-problem" title="Permalink to this headline">¶</a></h2>
<p>Let’s create a fuzzy control system which models how you might choose to tip
at a restaurant.  When tipping, you consider the service and food quality,
rated between 0 and 10.  You use this to leave a tip of between 0 and 25%.</p>
<p>We would formulate this problem as:</p>
<ul class="simple">
<li><dl class="simple">
<dt>Antecedents (Inputs)</dt><dd><ul>
<li><dl class="simple">
<dt><cite>service</cite></dt><dd><ul>
<li><p>Universe (ie, crisp value range): How good was the service of the wait
staff, on a scale of 0 to 10?</p></li>
<li><p>Fuzzy set (ie, fuzzy value range): poor, acceptable, amazing</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><cite>food quality</cite></dt><dd><ul>
<li><p>Universe: How tasty was the food, on a scale of 0 to 10?</p></li>
<li><p>Fuzzy set: bad, decent, great</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Consequents (Outputs)</dt><dd><ul>
<li><dl class="simple">
<dt><cite>tip</cite></dt><dd><ul>
<li><p>Universe: How much should we tip, on a scale of 0% to 25%</p></li>
<li><p>Fuzzy set: low, medium, high</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Rules</dt><dd><ul>
<li><p>IF the <em>service</em> was good  <em>or</em> the <em>food quality</em> was good,
THEN the tip will be high.</p></li>
<li><p>IF the <em>service</em> was average, THEN the tip will be medium.</p></li>
<li><p>IF the <em>service</em> was poor <em>and</em> the <em>food quality</em> was poor
THEN the tip will be low.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>Usage</dt><dd><ul>
<li><dl class="simple">
<dt>If I tell this controller that I rated:</dt><dd><ul>
<li><p>the service as 9.8, and</p></li>
<li><p>the quality as 6.5,</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>it would recommend I leave:</dt><dd><ul>
<li><p>a 20.2% tip.</p></li>
</ul>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="creating-the-tipping-controller-using-the-skfuzzy-control-api">
<h2>Creating the Tipping Controller Using the skfuzzy control API<a class="headerlink" href="#creating-the-tipping-controller-using-the-skfuzzy-control-api" title="Permalink to this headline">¶</a></h2>
<p>We can use the <cite>skfuzzy</cite> control system API to model this.  First, let’s
define fuzzy variables</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">skfuzzy</span> <span class="k">as</span> <span class="nn">fuzz</span>
<span class="kn">from</span> <span class="nn">skfuzzy</span> <span class="kn">import</span> <span class="n">control</span> <span class="k">as</span> <span class="n">ctrl</span>

<span class="c1"># New Antecedent/Consequent objects hold universe variables and membership</span>
<span class="c1"># functions</span>
<span class="n">quality</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Antecedent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;quality&#39;</span><span class="p">)</span>
<span class="n">service</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Antecedent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;service&#39;</span><span class="p">)</span>
<span class="n">tip</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Consequent</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="s1">&#39;tip&#39;</span><span class="p">)</span>

<span class="c1"># Auto-membership function population is possible with .automf(3, 5, or 7)</span>
<span class="n">quality</span><span class="o">.</span><span class="n">automf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="n">service</span><span class="o">.</span><span class="n">automf</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>

<span class="c1"># Custom membership functions can be built interactively with a familiar,</span>
<span class="c1"># Pythonic API</span>
<span class="n">tip</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">trimf</span><span class="p">(</span><span class="n">tip</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">])</span>
<span class="n">tip</span><span class="p">[</span><span class="s1">&#39;medium&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">trimf</span><span class="p">(</span><span class="n">tip</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
<span class="n">tip</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fuzz</span><span class="o">.</span><span class="n">trimf</span><span class="p">(</span><span class="n">tip</span><span class="o">.</span><span class="n">universe</span><span class="p">,</span> <span class="p">[</span><span class="mi">13</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">25</span><span class="p">])</span>
</pre></div>
</div>
<p>To help understand what the membership looks like, use the <code class="docutils literal notranslate"><span class="pre">view</span></code> methods.</p>
<p>These return the matplotlib <cite>Figure</cite> and <cite>Axis</cite> objects. They are persistent
as written in Jupyter notebooks; other environments may require a <cite>plt.show()</cite>
command after each <cite>.view()</cite>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># You can see how these look with .view()</span>
<span class="n">quality</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/plot_tipping_problem_newapi_1.png" src="../_images/plot_tipping_problem_newapi_1.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">service</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/plot_tipping_problem_newapi_2.png" src="../_images/plot_tipping_problem_newapi_2.png" />
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tip</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/plot_tipping_problem_newapi_3.png" src="../_images/plot_tipping_problem_newapi_3.png" />
</div>
<div class="section" id="fuzzy-rules">
<h2>Fuzzy rules<a class="headerlink" href="#fuzzy-rules" title="Permalink to this headline">¶</a></h2>
<p>Now, to make these triangles useful, we define the <em>fuzzy relationship</em>
between input and output variables. For the purposes of our example, consider
three simple rules:</p>
<ol class="arabic simple">
<li><p>If the food is poor OR the service is poor, then the tip will be low</p></li>
<li><p>If the service is average, then the tip will be medium</p></li>
<li><p>If the food is good OR the service is good, then the tip will be high.</p></li>
</ol>
<p>Most people would agree on these rules, but the rules are fuzzy. Mapping the
imprecise rules into a defined, actionable tip is a challenge. This is the
kind of task at which fuzzy logic excels.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rule1</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Rule</span><span class="p">(</span><span class="n">quality</span><span class="p">[</span><span class="s1">&#39;poor&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="n">service</span><span class="p">[</span><span class="s1">&#39;poor&#39;</span><span class="p">],</span> <span class="n">tip</span><span class="p">[</span><span class="s1">&#39;low&#39;</span><span class="p">])</span>
<span class="n">rule2</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Rule</span><span class="p">(</span><span class="n">service</span><span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">],</span> <span class="n">tip</span><span class="p">[</span><span class="s1">&#39;medium&#39;</span><span class="p">])</span>
<span class="n">rule3</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Rule</span><span class="p">(</span><span class="n">service</span><span class="p">[</span><span class="s1">&#39;good&#39;</span><span class="p">]</span> <span class="o">|</span> <span class="n">quality</span><span class="p">[</span><span class="s1">&#39;good&#39;</span><span class="p">],</span> <span class="n">tip</span><span class="p">[</span><span class="s1">&#39;high&#39;</span><span class="p">])</span>

<span class="n">rule1</span><span class="o">.</span><span class="n">view</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../_images/plot_tipping_problem_newapi_4.png" src="../_images/plot_tipping_problem_newapi_4.png" />
</div>
<div class="section" id="control-system-creation-and-simulation">
<h2>Control System Creation and Simulation<a class="headerlink" href="#control-system-creation-and-simulation" title="Permalink to this headline">¶</a></h2>
<p>Now that we have our rules defined, we can simply create a control system
via:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tipping_ctrl</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">ControlSystem</span><span class="p">([</span><span class="n">rule1</span><span class="p">,</span> <span class="n">rule2</span><span class="p">,</span> <span class="n">rule3</span><span class="p">])</span>
</pre></div>
</div>
<p>In order to simulate this control system, we will create a
<code class="docutils literal notranslate"><span class="pre">ControlSystemSimulation</span></code>.  Think of this object representing our controller
applied to a specific set of circumstances.  For tipping, this might be tipping
Sharon at the local brew-pub.  We would create another
<code class="docutils literal notranslate"><span class="pre">ControlSystemSimulation</span></code> when we’re trying to apply our <code class="docutils literal notranslate"><span class="pre">tipping_ctrl</span></code>
for Travis at the cafe because the inputs would be different.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tipping</span> <span class="o">=</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">ControlSystemSimulation</span><span class="p">(</span><span class="n">tipping_ctrl</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now simulate our control system by simply specifying the inputs
and calling the <code class="docutils literal notranslate"><span class="pre">compute</span></code> method.  Suppose we rated the quality 6.5 out of 10
and the service 9.8 of 10.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pass inputs to the ControlSystem using Antecedent labels with Pythonic API</span>
<span class="c1"># Note: if you like passing many inputs all at once, use .inputs(dict_of_data)</span>
<span class="n">tipping</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;quality&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">6.5</span>
<span class="n">tipping</span><span class="o">.</span><span class="n">input</span><span class="p">[</span><span class="s1">&#39;service&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">9.8</span>

<span class="c1"># Crunch the numbers</span>
<span class="n">tipping</span><span class="o">.</span><span class="n">compute</span><span class="p">()</span>
</pre></div>
</div>
<p>Once computed, we can view the result as well as visualize it.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">tipping</span><span class="o">.</span><span class="n">output</span><span class="p">[</span><span class="s1">&#39;tip&#39;</span><span class="p">])</span>
<span class="n">tip</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="n">sim</span><span class="o">=</span><span class="n">tipping</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/plot_tipping_problem_newapi_5.png" src="../_images/plot_tipping_problem_newapi_5.png" />
<p>The resulting suggested tip is <strong>19.84%</strong>.</p>
</div>
<div class="section" id="final-thoughts">
<h2>Final thoughts<a class="headerlink" href="#final-thoughts" title="Permalink to this headline">¶</a></h2>
<p>The power of fuzzy systems is allowing complicated, intuitive behavior based
on a sparse system of rules with minimal overhead. Note our membership
function universes were coarse, only defined at the integers, but
<code class="docutils literal notranslate"><span class="pre">fuzz.interp_membership</span></code> allowed the effective resolution to increase on
demand. This system can respond to arbitrarily small changes in inputs,
and the processing burden is minimal.</p>
<p><strong>Python source code:</strong> <a class="reference download internal" download="" href="../_downloads/a80f8cb57deb4141e91547163ba77874/plot_tipping_problem_newapi.py"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>
(generated using <code class="docutils literal notranslate"><span class="pre">skimage</span></code> 0.4.2)</p>
<p><strong>IPython Notebook:</strong> <a class="reference download internal" download="" href="../_downloads/73d25e9f2afeb5023afbb7a96cf89e33/plot_tipping_problem_newapi.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">download</span></code></a>
(generated using <code class="docutils literal notranslate"><span class="pre">skimage</span></code> 0.4.2)</p>
</div>
</div>


        </div>
        <div class="span3"><h4 class="sidebar-box-heading">Navigation</h4>
<div class="well sidebar-box">
    <ul class="nav nav-list">
        <li><a href="../index.html">Documentation Home</a></li>
    </ul>
</div>
    <h4 class="sidebar-box-heading">Previous topic</h4>
    <div class="well sidebar-box">
        <ul class="nav nav-list">
            <li><a href="plot_tipping_problem.html" title="previous chapter">The Tipping Problem - The Hard Way</a></li>
        </ul>
    </div>
    <h4 class="sidebar-box-heading">Next topic</h4>
    <div class="well sidebar-box">
        <ul class="nav nav-list">
            <li><a href="../documentation.html" title="next chapter">&lt;no title&gt;</a></li>
        </ul>
    </div>
        <h4 class="sidebar-box-heading">Contents</h4>
        <div class="well sidebar-box toc">
            <ul class="nav nav-list">
<li><a class="reference internal" href="#">Fuzzy Control Systems: The Tipping Problem</a><ul class="nav nav-list">
<li><a class="reference internal" href="#the-tipping-problem">The Tipping Problem</a></li>
<li><a class="reference internal" href="#creating-the-tipping-controller-using-the-skfuzzy-control-api">Creating the Tipping Controller Using the skfuzzy control API</a></li>
<li><a class="reference internal" href="#fuzzy-rules">Fuzzy rules</a></li>
<li><a class="reference internal" href="#control-system-creation-and-simulation">Control System Creation and Simulation</a></li>
<li><a class="reference internal" href="#final-thoughts">Final thoughts</a></li>
</ul>
</li>
</ul>

        </div>


        </div>
    </div>
    <div class="well footer">
        <small>
            &copy; Copyright the scikit-fuzzy development team.
            Created using <a href="http://twitter.github.com/bootstrap/">Bootstrap</a> and <a href="http://sphinx.pocoo.org/">Sphinx</a>.
            Thanks to <a href="http://scikit-image.org">scikit-image</a> team's template.
        </small>
    </div>
</body>
</html>